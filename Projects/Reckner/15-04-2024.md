---
title: Reckner
date: 2024-04-15
resources: 
tags:
---

1. ✅ /etc/shadow file permissions should be set to 0400 

**Description**
The /etc/shadow is like a safe place to store information of user accounts. Information like hashed passwords and other security information.

**impact**
If attackers get access to this file. They can easily break the hashed password by using a password cracking program. Other security information in the /etc/shadow file can be useful to compromise the user accounts.

**Solution**

- **Setting Ownership of `/etc/shadow`**

```bash
# chown root:root /etc/shadow
# chown root:shadow /etc/shadow
```

- The first command sets both the owner and group of `/etc/shadow` to `root`.
- The second command sets the group to `shadow`.

- **Removing Excess Permissions:**

```bash
# chmod u-x,g-wx,o-rwx /etc/shadow
```

- `u-x`: Removes execute permission for the file owner.
- `g-wx`: Removes write and execute permissions for the group.
- `o-rwx`: Removes read, write, and execute permissions to everyone else.

---

2. Ensure rsync service is not enabled

**Description**
*rsync* - This is a command-line utility used for synchronizing files and directories between systems over network.

**Impact**
It can be a security risk as it uses un-encrypted protocols (TCP port 873) for communication. Does not automatically encrypt the sensitive information during transit.

**Solution**
Disable rsync by using the below command

```bash
# systemctl --now disable rsync
```

---
3. ✅ Zeroconf networking should be disabled.

**Description**
Devices may automatically assign themselves an IP address and engage in IP communication without a statically-assigned address or even a DHCP server.

Zeroconf address assignment commonly occurs when the system is configured to use DHCP but fails to receive an address assignment from the DHCP server.

**impact**
Which could lead to unintended network connectivity.

**Solution**
To disable Zeroconf automatic route assignment in the *169.245.0.0* subnet, add or correct the following line in /etc/sysconfig/network

```bash
NOZEROCONF=yes
```

To disable in windows

```cmd
REG ADD HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters /v IPAutoconfigurationEnabled /t REG_DWORD /d "00000000" /f
```

---
4. /etc/passwd- file permissions should be set to 0600

**Description**
`/etc/passwd` is a file which contains the backup user account information. The `/etc/passwd` file keeps track of all users on the system.

`/etc/passwd` is a plain text-based database that contains information for all user accounts on the system. It is [owned](https://linuxize.com/post/chmod-command-in-linux/) by root and has 644 [permissions](https://linuxize.com/post/linux-chown-command/) . The file can only be modified by root or users with [sudo](https://linuxize.com/post/sudo-command-in-linux/) privileges and readable by all system users.

Modifying the `/etc/passwd` file by hand should be avoided unless you know what you are doing. Always use a command that is designed for the purpose. For example, to modify a user account, use the [`usermod`](https://linuxize.com/post/usermod-command-in-linux/) command, and to add a new user account use the [`useradd`](https://linuxize.com/post/how-to-create-users-in-linux-using-the-useradd-command/) command.




---
5. Performing source validation by reverse path should be enabled for all interfaces. (net. Ipv4. Conf. Default. Rp_filter = 1)

Setting net.ipv4.conf.all.rp_filter and net.ipv4.conf.default.rp_filter to 1 forces the Linux kernel to utilize reverse path filtering on a received packet to determine if the packet was valid. Essentially, with reverse path filtering, if the return packet does not go out the same interface that the corresponding source packet came from, the packet is dropped (and logged if log_martians is set).  
  
Rationale:  
  
Setting these flags is a good way to deter attackers from sending your system bogus packets that cannot be responded to. One instance where this feature breaks down is if asymmetrical routing is employed. This would occur when using dynamic routing protocols (bgp, ospf, etc) on your system. If you are using asymmetrical routing on your system, you will not be able to enable this feature without breaking the routing.  

#### Solution

Set the following parameters in /etc/sysctl.conf or a /etc/sysctl.d/* file:  
  
net.ipv4.conf.all.rp_filter = 1  
net.ipv4.conf.default.rp_filter = 1  
  
Run the following commands to set the active kernel parameters:  
  
`# sysctl -w net.ipv4.conf.all.rp_filter=1 `
`# sysctl -w net.ipv4.conf.default.rp_filter=1  `
`# sysctl -w net.ipv4.route.flush=1`

Certainly! The recommendation is about a security feature called **reverse path filtering**. This feature checks if the path that a packet takes to reach your computer is the same path it would take to go back. If it’s not, the packet is considered suspicious and is discarded. This helps protect your system from attackers who might try to send harmful or fake packets to your computer. However, there’s a catch: if your system uses different paths for incoming and outgoing traffic (known as asymmetrical routing), enabling this feature could disrupt the normal flow of traffic. So, if your system relies on asymmetrical routing, you shouldn’t turn on reverse path filtering, or it might interfere with your network’s operation.🛡️

---
6. The portmap service should be disabled.

[Disable the portmapper services (bobcares.com)](https://bobcares.com/blog/disable-the-portmapper-services/)

---
7. The sendmail package should be uninstalled.

Sendmail is a **mail transfer agent (MTA)**, which is a software that transports email messages from one computer to another using SMTP, the standard protocol for sending emails.

Sendmail has had several vulnerabilities over the years.

**SMTP Smuggling** - **CVE-2023-51765**
**MIME Message Denial of Service** - **CVE-2014-3956**
**X.509 Certificate Handling** - **CVE-2009-4565**
**Heap-Based Buffer Overflow** - **CVE-2009-1490**

%%
1. **SMTP Smuggling (CVE-2023-51765)**:
    
    - **Description**: Sendmail through version 8.17.2 allows **SMTP smuggling** in certain configurations. Remote attackers can exploit this vulnerability to inject email messages with a spoofed MAIL FROM address, bypassing SPF (Sender Policy Framework) protection mechanisms. [The issue arises because sendmail supports `<LF>.<CR><LF>`, but some other popular email servers do not](https://www.cvedetails.com/vulnerability-list/vendor_id-31/Sendmail.html?page=1&order=1&trc=33&sha=f0b338b9046d95480b9f952106780cd6f123d91a)[1](https://www.cvedetails.com/vulnerability-list/vendor_id-31/Sendmail.html?page=1&order=1&trc=33&sha=f0b338b9046d95480b9f952106780cd6f123d91a)[2](https://nvd.nist.gov/vuln/detail/CVE-2023-51765).
    - **Impact**: This vulnerability can lead to unauthorized email spoofing and potentially compromise SPF protections.
    - **Solution**: The issue is resolved in sendmail versions 8.18 and later with the addition of ‘o’ in `srv_features`.
2. **MIME Message Denial of Service (CVE-2014-3956)**:
    
    - **Description**: Sendmail before version 8.14.9 allows remote attackers to cause a denial of service by sending deeply nested, malformed multipart MIME messages. These messages exhaust the stack during the recursive `mime8to7` function, which performs 8-bit to 7-bit conversion. [As a result, sendmail may fail to deliver queued messages and could lead to disk consumption by core dump files](https://www.cvedetails.com/vulnerability-list/vendor_id-31/product_id-45/version_id-394516/Sendmail-Sendmail-8.13.1.html)[3](https://www.cvedetails.com/vulnerability-list/vendor_id-31/product_id-45/version_id-394516/Sendmail-Sendmail-8.13.1.html).
    - **Impact**: Denial of service and potential disk space exhaustion.
    - **Solution**: Upgrade to a version of sendmail that addresses this vulnerability.
3. **X.509 Certificate Handling (CVE-2009-4565)**:
    
    - **Description**: Sendmail before version 8.14.4 does not properly handle a ‘\0’ character in a Common Name (CN) field of an X.509 certificate. This allows man-in-the-middle attackers to spoof SSL-based SMTP servers using crafted server certificates issued by legitimate Certification Authorities. [It also enables remote attackers to bypass access restrictions using crafted client certificates issued by legitimate Certification Authorities](https://www.cvedetails.com/vulnerability-list/vendor_id-31/Sendmail.html?page=1&order=1&trc=33&sha=f0b338b9046d95480b9f952106780cd6f123d91a)[1](https://www.cvedetails.com/vulnerability-list/vendor_id-31/Sendmail.html?page=1&order=1&trc=33&sha=f0b338b9046d95480b9f952106780cd6f123d91a).
    - **Impact**: Potential man-in-the-middle attacks and bypassing access controls.
    - **Solution**: Upgrade to a secure version of sendmail.
4. **Heap-Based Buffer Overflow (CVE-2009-1490)**:
    
    - **Description**: A heap-based buffer overflow in Sendmail before version 8.13.2 allows remote attackers to cause a denial of service (daemon crash) and potentially execute arbitrary code via a long X-header. [For example, an X-Testing header could trigger this vulnerability](https://www.cvedetails.com/vulnerability-list/vendor_id-31/Sendmail.html?page=1&order=1&trc=33&sha=f0b338b9046d95480b9f952106780cd6f123d91a)[1](https://www.cvedetails.com/vulnerability-list/vendor_id-31/Sendmail.html?page=1&order=1&trc=33&sha=f0b338b9046d95480b9f952106780cd6f123d91a).
    - **Impact**: Denial of service and potential code execution.
    - **Solution**: Update to a fixed version of sendmail.
%%